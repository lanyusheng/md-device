# å¤šç§Ÿæˆ·æƒé™ç³»ç»Ÿå®ç°æ€»ç»“

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. åŸºç¡€è®¾æ–½å±‚

#### ç±»å‹å®šä¹‰ (100%)
- âœ… `src/types/permission.ts` - æƒé™æ¨¡å—ç±»å‹
  - Role, LocationUser, Module, Interface
  - è¡¨å•å€¼ç±»å‹å’Œè¯·æ±‚ç±»å‹
  - é€‰é¡¹æ•°æ®å’Œæ ‘å½¢ç»“æ„ç±»å‹

- âœ… `src/types/company.ts` - å…¬å¸æ¨¡å—ç±»å‹
  - Company, Business
  - çŠ¶æ€æšä¸¾å’Œé€‰é¡¹æ•°æ®
  - ä¸Šä¸‹æ–‡ç±»å‹

#### æœåŠ¡å±‚ (100%)
- âœ… `src/services/permission.service.ts`
  - roleService: è§’è‰² CRUD
  - locationUserService: æ“ä½œå‘˜ç®¡ç†
  - moduleService: æ¨¡å—ç®¡ç†å’Œæˆæƒ
  - interfaceService: æ¥å£ç®¡ç†å’Œæˆæƒ

- âœ… `src/services/company.service.ts`
  - getCompanyList: è·å–å…¬å¸åˆ—è¡¨
  - intoCompany: åˆ‡æ¢å…¬å¸ï¼ˆå«Tokenæ›´æ–°ï¼‰
  - getCompanyBusinessList: è·å–ä¸šåŠ¡åˆ—è¡¨

### 2. å…¬å¸ç®¡ç†æ¨¡å— (100%)

#### ç›®å½•ç»“æ„
```
src/features/companies/
â”œâ”€â”€ store/
â”‚   â””â”€â”€ company.store.ts           âœ… ZustandçŠ¶æ€ç®¡ç†
â””â”€â”€ components/
    â”œâ”€â”€ company-listing.tsx        âœ… åˆ—è¡¨å®¹å™¨
    â””â”€â”€ company-tables/
        â”œâ”€â”€ columns.tsx            âœ… è¡¨æ ¼åˆ—å®šä¹‰
        â”œâ”€â”€ company-toolbar.tsx    âœ… å·¥å…·æ 
        â”œâ”€â”€ cell-action.tsx        âœ… è¡Œæ“ä½œ
        â””â”€â”€ index.tsx              âœ… è¡¨æ ¼ç»„ä»¶
```

#### é¡µé¢è·¯ç”±
- âœ… `/dashboard/companies` - å…¬å¸ç®¡ç†é¡µé¢

#### æ ¸å¿ƒåŠŸèƒ½
- âœ… å…¬å¸åˆ—è¡¨å±•ç¤ºï¼ˆåˆ†é¡µã€æ’åºã€æœç´¢ï¼‰
- âœ… çŠ¶æ€è¿‡æ»¤ï¼ˆå¯ç”¨/ç¦ç”¨ï¼‰
- âœ… è¿›å…¥å…¬å¸ï¼ˆåˆ‡æ¢å…¬å¸ä¸Šä¸‹æ–‡ï¼‰
- âœ… Tokenè‡ªåŠ¨æ›´æ–°
- âœ… å½“å‰å…¬å¸æ˜¾ç¤º

### 3. è§’è‰²ç®¡ç†æ¨¡å— (100%)

#### ç›®å½•ç»“æ„
```
src/features/roles/
â”œâ”€â”€ store/
â”‚   â””â”€â”€ role.store.ts              âœ… ZustandçŠ¶æ€ç®¡ç†
â””â”€â”€ components/
    â”œâ”€â”€ role-listing.tsx           âœ… åˆ—è¡¨å®¹å™¨
    â”œâ”€â”€ role-drawer.tsx            âœ… è¡¨å•æŠ½å±‰ï¼ˆåˆ›å»º/ç¼–è¾‘ï¼‰
    â””â”€â”€ role-tables/
        â”œâ”€â”€ columns.tsx            âœ… è¡¨æ ¼åˆ—å®šä¹‰
        â”œâ”€â”€ role-toolbar.tsx       âœ… å·¥å…·æ 
        â”œâ”€â”€ cell-action.tsx        âœ… è¡Œæ“ä½œï¼ˆç¼–è¾‘/åˆ é™¤/åˆ†é…æƒé™ï¼‰
        â””â”€â”€ index.tsx              âœ… è¡¨æ ¼ç»„ä»¶
```

#### é¡µé¢è·¯ç”±
- âœ… `/dashboard/roles` - è§’è‰²ç®¡ç†é¡µé¢

#### æ ¸å¿ƒåŠŸèƒ½
- âœ… è§’è‰²åˆ—è¡¨å±•ç¤ºï¼ˆåˆ†é¡µã€æ’åºã€æœç´¢ï¼‰
- âœ… åˆ›å»ºè§’è‰²
- âœ… ç¼–è¾‘è§’è‰²
- âœ… åˆ é™¤è§’è‰²ï¼ˆå«ç¡®è®¤å¯¹è¯æ¡†ï¼‰
- âœ… è·³è½¬æƒé™åˆ†é…

### 4. æƒé™åˆ†é…æ¨¡å— (100%)

#### ç›®å½•ç»“æ„
```
src/features/permissions/
â””â”€â”€ store/
    â””â”€â”€ permission.store.ts        âœ… æƒé™çŠ¶æ€ç®¡ç†
```

#### é¡µé¢è·¯ç”±
- âœ… `/dashboard/permissions/assign?roleId=xxx&roleName=xxx`

#### æ ¸å¿ƒåŠŸèƒ½
- âœ… æ˜¾ç¤ºæ‰€æœ‰æ¨¡å—ï¼ˆå¯å¤šé€‰ï¼‰
- âœ… æ˜¾ç¤ºæ‰€æœ‰æ¥å£ï¼ˆæŒ‰æ¨¡å—åˆ†ç»„ï¼‰
- âœ… æ¨¡å—æƒé™é€‰æ‹©ï¼ˆå…¨é€‰/æ¸…ç©ºï¼‰
- âœ… æ¥å£æƒé™é€‰æ‹©ï¼ˆå…¨é€‰/æ¸…ç©ºï¼‰
- âœ… åŠ è½½è§’è‰²ç°æœ‰æƒé™
- âœ… ä¿å­˜æƒé™ï¼ˆæ¨¡å—+æ¥å£ï¼‰
- âœ… å®æ—¶é€‰æ‹©çŠ¶æ€åŒæ­¥

---

## ğŸš§ å¾…å®ç°åŠŸèƒ½

### 1. æ“ä½œå‘˜ç®¡ç†æ¨¡å— (æœªå¼€å§‹)

**é¢„è®¡å·¥ä½œé‡**: 3-4å°æ—¶

éœ€è¦åˆ›å»º:
```
src/features/users/
â”œâ”€â”€ store/
â”‚   â””â”€â”€ user.store.ts
â””â”€â”€ components/
    â”œâ”€â”€ user-listing.tsx
    â”œâ”€â”€ user-drawer.tsx
    â””â”€â”€ user-tables/
        â”œâ”€â”€ columns.tsx
        â”œâ”€â”€ user-toolbar.tsx
        â”œâ”€â”€ cell-action.tsx
        â””â”€â”€ index.tsx
```

**é¡µé¢è·¯ç”±**:
- `/dashboard/users`

**åŠŸèƒ½æ¸…å•**:
- [ ] æ“ä½œå‘˜åˆ—è¡¨ï¼ˆåˆ†é¡µã€æœç´¢ï¼‰
- [ ] æ·»åŠ æ“ä½œå‘˜
- [ ] åˆ†é…è§’è‰²
- [ ] ç§»é™¤æ“ä½œå‘˜
- [ ] çŠ¶æ€è¿‡æ»¤

### 2. ä¸šåŠ¡ç®¡ç†æ¨¡å— (æœªå¼€å§‹)

**é¢„è®¡å·¥ä½œé‡**: 2-3å°æ—¶

éœ€è¦åˆ›å»º:
```
src/features/businesses/
â””â”€â”€ components/
    â”œâ”€â”€ business-listing.tsx
    â””â”€â”€ business-tables/
        â”œâ”€â”€ columns.tsx
        â””â”€â”€ index.tsx
```

**é¡µé¢è·¯ç”±**:
- `/dashboard/businesses`

**åŠŸèƒ½æ¸…å•**:
- [ ] ä¸šåŠ¡åˆ—è¡¨å±•ç¤º
- [ ] ä¸šåŠ¡çŠ¶æ€æ˜¾ç¤º
- [ ] æœç´¢è¿‡æ»¤

### 3. æƒé™å®ˆå«ç³»ç»Ÿ (æœªå¼€å§‹)

**é¢„è®¡å·¥ä½œé‡**: 3-4å°æ—¶

éœ€è¦åˆ›å»º:
```
src/
â”œâ”€â”€ middleware.ts                    # Next.jsä¸­é—´ä»¶
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ use-permission.ts           # æƒé™Hook
â””â”€â”€ components/
    â””â”€â”€ auth/
        â””â”€â”€ permission-guard.tsx    # æƒé™å®ˆå«ç»„ä»¶
```

**åŠŸèƒ½æ¸…å•**:
- [ ] è·¯ç”±çº§æƒé™æ§åˆ¶
- [ ] ç»„ä»¶çº§æƒé™æ§åˆ¶
- [ ] æŒ‰é’®çº§æƒé™æ§åˆ¶
- [ ] 403é¡µé¢

### 4. ä¾§è¾¹æ å¯¼èˆªé›†æˆ (æœªå¼€å§‹)

**é¢„è®¡å·¥ä½œé‡**: 2-3å°æ—¶

éœ€è¦ä¿®æ”¹:
```
src/components/layout/sidebar.tsx
```

**åŠŸèƒ½æ¸…å•**:
- [ ] æ ¹æ®ç”¨æˆ·æ¨¡å—æƒé™åŠ¨æ€ç”Ÿæˆèœå•
- [ ] éšè—æ— æƒé™èœå•é¡¹
- [ ] æ”¯æŒå¤šçº§èœå•åµŒå¥—
- [ ] èœå•å›¾æ ‡é…ç½®

---

## ğŸ“‹ å¿«é€Ÿå¼€å§‹ä½¿ç”¨æŒ‡å—

### 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
pnpm dev
```

### 2. è®¿é—®åŠŸèƒ½é¡µé¢

1. **ç™»å½•ç³»ç»Ÿ**
   - è®¿é—®: `http://localhost:3000/login`
   - ç™»å½•åè‡ªåŠ¨è·³è½¬Dashboard

2. **å…¬å¸ç®¡ç†**
   - è®¿é—®: `http://localhost:3000/dashboard/companies`
   - å¯æŸ¥çœ‹å…¬å¸åˆ—è¡¨
   - ç‚¹å‡»"è¿›å…¥å…¬å¸"åˆ‡æ¢å…¬å¸ä¸Šä¸‹æ–‡

3. **è§’è‰²ç®¡ç†**
   - è®¿é—®: `http://localhost:3000/dashboard/roles`
   - åˆ›å»ºè§’è‰²ï¼šç‚¹å‡»"æ–°å»ºè§’è‰²"
   - ç¼–è¾‘è§’è‰²ï¼šç‚¹å‡»è¡Œæ“ä½œ"ç¼–è¾‘"
   - åˆ é™¤è§’è‰²ï¼šç‚¹å‡»è¡Œæ“ä½œ"åˆ é™¤"
   - åˆ†é…æƒé™ï¼šç‚¹å‡»è¡Œæ“ä½œ"åˆ†é…æƒé™"

4. **æƒé™åˆ†é…**
   - ä»è§’è‰²ç®¡ç†é¡µé¢ç‚¹å‡»"åˆ†é…æƒé™"
   - æˆ–ç›´æ¥è®¿é—®: `/dashboard/permissions/assign?roleId=1&roleName=ç®¡ç†å‘˜`
   - å‹¾é€‰æ¨¡å—å’Œæ¥å£
   - ç‚¹å‡»"ä¿å­˜"

### 3. APIå¯¹æ¥æ³¨æ„äº‹é¡¹

**é‡è¦**: å½“å‰æ‰€æœ‰æœåŠ¡å±‚çš„`UserLocation`å‚æ•°ä½¿ç”¨çš„æ˜¯å ä½æ•°æ®ï¼š

```typescript
{
  UserLocation: {
    AuthorizationLevel: 0,
    TenantID: 0,
    CompanyID: 0,
    BusinessID: '',
    LocationID: 0,
    MobilePhone: '',
    UID: '',
    RequestTicket: '',
    Token: '',
    CompanyAccessToken: '',
    LocationAccessToken: ''
  }
}
```

**éœ€è¦ä¿®æ”¹**:
1. ä»ç™»å½•åçš„ç”¨æˆ·ä¿¡æ¯ä¸­è·å–çœŸå®çš„`UserLocation`æ•°æ®
2. å­˜å‚¨åˆ°å…¨å±€çŠ¶æ€ï¼ˆå»ºè®®ç”¨Zustandï¼‰
3. åœ¨APIè°ƒç”¨æ—¶ä½¿ç”¨çœŸå®æ•°æ®

**å»ºè®®åˆ›å»º**:
```typescript
// src/stores/auth.store.ts
export const useAuthStore = create((set) => ({
  userLocation: null,
  setUserLocation: (location) => set({ userLocation: location })
}));

// ä½¿ç”¨æ—¶
const { userLocation } = useAuthStore();
await apiClient.post('/Permission/GetRoleList', {
  UserLocation: userLocation,
  ...otherParams
});
```

---

## ğŸ¨ UIç»„ä»¶åº“ä½¿ç”¨è¯´æ˜

### å·²ä½¿ç”¨çš„Shadcnç»„ä»¶

- âœ… Button
- âœ… Table (TanStack Table)
- âœ… Input
- âœ… Checkbox
- âœ… Badge
- âœ… Dropdown Menu
- âœ… Alert Dialog
- âœ… Drawer
- âœ… Form (React Hook Form)
- âœ… Card
- âœ… Scroll Area
- âœ… Separator
- âœ… Heading

### è¡¨æ ¼åŠŸèƒ½ç‰¹æ€§

éµå¾ªé¡¹ç›®è§„èŒƒï¼Œæ‰€æœ‰è¡¨æ ¼éƒ½æ”¯æŒï¼š
- å…¨å±€æœç´¢
- åˆ—æ’åº
- åˆ—è¿‡æ»¤ï¼ˆçŠ¶æ€ç­‰ï¼‰
- åˆ—æ˜¾ç¤º/éšè—
- åˆ†é¡µ
- å¤šé€‰
- è¡Œæ“ä½œ

---

## ğŸ”§ æŠ€æœ¯æ ˆæ€»ç»“

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Next.js | 15.x | Reactæ¡†æ¶ |
| React | 19.x | UIåº“ |
| TypeScript | 5.x | ç±»å‹ç³»ç»Ÿ |
| Tailwind CSS | 3.x | æ ·å¼æ–¹æ¡ˆ |
| Shadcn-ui | - | ç»„ä»¶åº“ |
| TanStack Table | 8.x | è¡¨æ ¼ç»„ä»¶ |
| React Hook Form | 7.x | è¡¨å•ç®¡ç† |
| Zod | 3.x | æ•°æ®æ ¡éªŒ |
| Zustand | 4.x | çŠ¶æ€ç®¡ç† |
| Sonner | - | Toasté€šçŸ¥ |

---

## ğŸ“‚ å®Œæ•´ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ api.ts                      # (åŸæœ‰) APIå“åº”ç±»å‹
â”‚   â”œâ”€â”€ permission.ts               # âœ… æƒé™ç±»å‹
â”‚   â””â”€â”€ company.ts                  # âœ… å…¬å¸ç±»å‹
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ auth.service.ts            # (åŸæœ‰) ç™»å½•æœåŠ¡
â”‚   â”œâ”€â”€ device.service.ts          # (åŸæœ‰) è®¾å¤‡æœåŠ¡
â”‚   â”œâ”€â”€ permission.service.ts      # âœ… æƒé™æœåŠ¡
â”‚   â””â”€â”€ company.service.ts         # âœ… å…¬å¸æœåŠ¡
â”œâ”€â”€ features/
â”‚   â”œâ”€â”€ devices/                   # (åŸæœ‰) è®¾å¤‡ç®¡ç†
â”‚   â”œâ”€â”€ companies/                 # âœ… å…¬å¸ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â””â”€â”€ components/
â”‚   â”œâ”€â”€ roles/                     # âœ… è§’è‰²ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â””â”€â”€ components/
â”‚   â””â”€â”€ permissions/               # âœ… æƒé™åˆ†é…
â”‚       â””â”€â”€ store/
â””â”€â”€ app/
    â”œâ”€â”€ login/                     # (åŸæœ‰) ç™»å½•é¡µ
    â””â”€â”€ dashboard/
        â”œâ”€â”€ devices/               # (åŸæœ‰) è®¾å¤‡ç®¡ç†é¡µ
        â”œâ”€â”€ companies/             # âœ… å…¬å¸ç®¡ç†é¡µ
        â”œâ”€â”€ roles/                 # âœ… è§’è‰²ç®¡ç†é¡µ
        â””â”€â”€ permissions/
            â””â”€â”€ assign/            # âœ… æƒé™åˆ†é…é¡µ
```

---

## ğŸ› å·²çŸ¥é—®é¢˜

1. **UserLocationå‚æ•°**: å½“å‰ä½¿ç”¨å ä½æ•°æ®ï¼Œéœ€è¦å¯¹æ¥çœŸå®ç™»å½•ä¿¡æ¯
2. **æƒé™å®ˆå«**: å°šæœªå®ç°ï¼Œæ‰€æœ‰é¡µé¢ç›®å‰æ— æƒé™æ§åˆ¶
3. **ä¾§è¾¹æ èœå•**: æœªé›†æˆæƒé™æ§åˆ¶ï¼Œéœ€æ‰‹åŠ¨æ·»åŠ è·¯ç”±

---

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

æŒ‰ä¼˜å…ˆçº§æ’åº:

1. **é«˜ä¼˜å…ˆçº§** (å¿…é¡»å®Œæˆ)
   - [ ] ä¿®å¤UserLocationå‚æ•°ï¼ˆå¯¹æ¥çœŸå®ç™»å½•ä¿¡æ¯ï¼‰
   - [ ] å®ç°æƒé™å®ˆå«ç³»ç»Ÿ
   - [ ] é›†æˆä¾§è¾¹æ å¯¼èˆªèœå•

2. **ä¸­ä¼˜å…ˆçº§** (é‡è¦åŠŸèƒ½)
   - [ ] å®Œæˆæ“ä½œå‘˜ç®¡ç†æ¨¡å—
   - [ ] å®Œæˆä¸šåŠ¡ç®¡ç†æ¨¡å—

3. **ä½ä¼˜å…ˆçº§** (å¯é€‰åŠŸèƒ½)
   - [ ] æ·»åŠ æƒé™å®¡è®¡æ—¥å¿—
   - [ ] æ·»åŠ æ‰¹é‡æ“ä½œ
   - [ ] æ·»åŠ å¯¼å‡ºåŠŸèƒ½

---

## ğŸ“ å¼€å‘è§„èŒƒæ€»ç»“

æ‰€æœ‰ä»£ç ä¸¥æ ¼éµå¾ªé¡¹ç›®è§„èŒƒ:

1. **Feature-basedæ¶æ„**: æŒ‰ä¸šåŠ¡åŠŸèƒ½ç»„ç»‡ä»£ç 
2. **ç»„ä»¶åˆ†å±‚**: Page â†’ Container â†’ UI Components
3. **ç±»å‹å®šä¹‰**: å®Œæ•´çš„TypeScriptç±»å‹
4. **è¡¨æ ¼è§„èŒƒ**: TanStack Table + æ ‡å‡†åŒ–åˆ—å®šä¹‰
5. **è¡¨å•è§„èŒƒ**: React Hook Form + Zodæ ¡éªŒ
6. **çŠ¶æ€ç®¡ç†**: Zustand + devtools
7. **é”™è¯¯å¤„ç†**: ç»Ÿä¸€Toastæç¤º
8. **å‘½åè§„èŒƒ**: kebab-caseæ–‡ä»¶åï¼ŒPascalCaseç»„ä»¶å

---

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥:
1. APIæ¥å£æ–‡æ¡£ `swagger.json`
2. å¼€å‘æŒ‡å— `DEVELOPMENT_GUIDE.md`
3. ä½¿ç”¨è¯´æ˜ `è®¾å¤‡ç®¡ç†ä½¿ç”¨è¯´æ˜.md`
4. æœ¬æ–‡æ¡£ `PERMISSION_SYSTEM_IMPLEMENTATION.md`

---

**æœ€åæ›´æ–°æ—¶é—´**: 2025-01-XX

**å®ç°è€…**: Claude Code

**çŠ¶æ€**: âœ… æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆ | ğŸš§ è¾…åŠ©åŠŸèƒ½å¾…å®Œæˆ
